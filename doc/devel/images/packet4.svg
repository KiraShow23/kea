<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1622px" preserveAspectRatio="none" style="width:1541px;height:1622px;" version="1.1" viewBox="0 0 1541 1622" width="1541px" zoomAndPan="magnify"><defs><filter height="300%" id="f10gx5l1vihluf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="231" x="646" y="17.4023">DHCPv4 packet processing</text><!--MD5=[91c043391605f0bbc36c648123f05f04]
cluster process--><rect fill="#FFFFFF" filter="url(#f10gx5l1vihluf)" height="103" style="stroke: #000000; stroke-width: 1.5;" width="849" x="205" y="749.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="257" x="501" y="764.7344">Process Query on its Message Type</text><!--MD5=[a6437f938727ef6368484703a6d5a51f]
entity processDiscover--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="134" x="396" y="792.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="406" y="815.7344">Process Discover</text><!--MD5=[776f46e8e787ed3ff8f7399fa81d4ef1]
entity processRequest--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="131" x="229.5" y="792.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="239.5" y="815.7344">Process Request</text><!--MD5=[fc7d6e37f840cd9a10a681e81df6f28b]
entity processRelease--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="726" y="792.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="736" y="815.7344">Process Release</text><!--MD5=[8d825f552c438f1d41e38a94f08e3f47]
entity processDecline--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="565" y="792.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="575" y="815.7344">Process Decline</text><!--MD5=[3b341f45531d1fcf2cf88cb83e9fdef4]
entity processInform--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="122" x="889" y="792.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="102" x="899" y="815.7344">Process Inform</text><!--MD5=[aa62c1eea3f70b4dbb2d8a2ad04d8b75]
entity receivePacket--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="1239" y="28.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1249" y="51.7344">Receive query</text><path d="M1150,33.6992 L1150,59.0098 A0,0 0 0 0 1150,59.0098 L1204,59.0098 A0,0 0 0 0 1204,59.0098 L1204,51.6992 L1238.77,46.1992 L1204,43.6992 L1204,43.6992 L1194,33.6992 L1150,33.6992 A0,0 0 0 0 1150,33.6992 " fill="#FBFB77" filter="url(#f10gx5l1vihluf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1194,33.6992 L1194,43.6992 L1204,43.6992 L1194,33.6992 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="1156" y="51.2676">input</text><!--MD5=[37dd4220ca2f2608029cfa1ef00c2d62]
entity isServiceEnabled--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1232.5" y="125.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="1242.5" y="148.7344">Service Enabled</text><!--MD5=[f1e4a9c8bda8d25100748cfdff400bf1]
entity buffer4_receive--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="1087.5" y="238.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="159" x="1097.5" y="261.7344">Callout buffer4_receive</text><path d="M1301.5,243.6992 L1301.5,252.1992 L1266.66,256.1992 L1301.5,260.1992 L1301.5,269.0098 A0,0 0 0 0 1301.5,269.0098 L1354.5,269.0098 A0,0 0 0 0 1354.5,269.0098 L1354.5,253.6992 L1344.5,243.6992 L1301.5,243.6992 A0,0 0 0 0 1301.5,243.6992 " fill="#FBFB77" filter="url(#f10gx5l1vihluf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1344.5,243.6992 L1344.5,253.6992 L1354.5,253.6992 L1344.5,243.6992 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1307.5" y="261.2676">hook</text><!--MD5=[ce6c3f645c8aec4915456c978c48f6f1]
entity unpack--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="990" y="351.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1000" y="374.7344">Unpack query</text><!--MD5=[f8582116def27e35cdbbbf5463e43073]
entity classify--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="989.5" y="448.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="95" x="999.5" y="471.7344">Classify query</text><!--MD5=[92aee3b8b080bbd52e01e7cb395370c4]
entity pkt4_receive--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="159" x="966.5" y="545.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="976.5" y="568.7344">Callout pkt4_receive</text><path d="M1160.5,550.6992 L1160.5,559.1992 L1125.59,563.1992 L1160.5,567.1992 L1160.5,576.0098 A0,0 0 0 0 1160.5,576.0098 L1213.5,576.0098 A0,0 0 0 0 1213.5,576.0098 L1213.5,560.6992 L1203.5,550.6992 L1160.5,550.6992 A0,0 0 0 0 1160.5,550.6992 " fill="#FBFB77" filter="url(#f10gx5l1vihluf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1203.5,550.6992 L1203.5,560.6992 L1213.5,560.6992 L1203.5,550.6992 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1166.5" y="568.2676">hook</text><!--MD5=[7aeeef4718a003ce2e7ad9bcbdf71ad9]
entity drop_class--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="975.5" y="658.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="985.5" y="681.7344">Check DROP class</text><!--MD5=[a8af8e48f2cc558a0fee70431885f908]
entity lease4_committed--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="197" x="530.5" y="923.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="177" x="540.5" y="946.7344">Callout lease4_committed</text><path d="M762.5,928.6992 L762.5,937.1992 L727.75,941.1992 L762.5,945.1992 L762.5,954.0098 A0,0 0 0 0 762.5,954.0098 L815.5,954.0098 A0,0 0 0 0 815.5,954.0098 L815.5,938.6992 L805.5,928.6992 L762.5,928.6992 A0,0 0 0 0 762.5,928.6992 " fill="#FBFB77" filter="url(#f10gx5l1vihluf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M805.5,928.6992 L805.5,938.6992 L815.5,938.6992 L805.5,928.6992 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="768.5" y="946.2676">hook</text><!--MD5=[8e18f13991ca58e5a79e0b81ed56b9db]
entity park--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="50" x="612" y="1036.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="622" y="1059.7344">Park</text><!--MD5=[145fde1089ff11319f35031b66a8b2bf]
entity pkt4_send--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="443" y="1149.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="453" y="1172.7344">Callout pkt4_send</text><!--MD5=[62d5b04920c444814fafa1dbf06b35cd]
entity send--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="537.5" y="1472.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="547.5" y="1495.7344">Send response</text><!--MD5=[5f600c2348a98514851ba709bbd3f597]
entity pack--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="456" y="1262.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="466" y="1285.7344">Pack response</text><!--MD5=[d6829aa81ee0cd45a2e878b8b13197d5]
entity buffer4_send--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="164" x="549" y="1359.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="559" y="1382.7344">Callout buffer4_send</text><path d="M439.5,1477.6992 L439.5,1503.0098 A0,0 0 0 0 439.5,1503.0098 L502.5,1503.0098 A0,0 0 0 0 502.5,1503.0098 L502.5,1495.6992 L537.35,1490.1992 L502.5,1487.6992 L502.5,1487.6992 L492.5,1477.6992 L439.5,1477.6992 A0,0 0 0 0 439.5,1477.6992 " fill="#FBFB77" filter="url(#f10gx5l1vihluf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M492.5,1477.6992 L492.5,1487.6992 L502.5,1487.6992 L492.5,1477.6992 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="445.5" y="1495.2676">output</text><!--MD5=[c92710f32fe9c293a125fb7e80204a05]
entity drop--><rect fill="#FEFECE" filter="url(#f10gx5l1vihluf)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="103" x="677.5" y="1569.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="687.5" y="1592.7344">Drop packet</text><path d="M591.5,1574.6992 L591.5,1600.0098 A0,0 0 0 0 591.5,1600.0098 L642.5,1600.0098 A0,0 0 0 0 642.5,1600.0098 L642.5,1592.6992 L677.49,1587.1992 L642.5,1584.6992 L642.5,1584.6992 L632.5,1574.6992 L591.5,1574.6992 A0,0 0 0 0 591.5,1574.6992 " fill="#FBFB77" filter="url(#f10gx5l1vihluf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M632.5,1574.6992 L632.5,1584.6992 L642.5,1584.6992 L632.5,1574.6992 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="597.5" y="1592.2676">error</text><!--MD5=[9670815d90e482d849702fdd57183fae]
link receivePacket to isServiceEnabled--><path d="M1296,64.6192 C1296,80.1592 1296,102.9792 1296,119.8592 " fill="none" id="receivePacket-&gt;isServiceEnabled" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1296,124.8892,1300,115.8892,1296,119.8892,1292,115.8892,1296,124.8892" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[8b6c78e5054b687dbc9e19308d3a0129]
link isServiceEnabled to buffer4_receive--><path d="M1277.67,161.2992 C1256.59,180.9592 1221.99,213.2292 1199.35,234.3492 " fill="none" id="isServiceEnabled-&gt;buffer4_receive" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1195.55,237.8992,1204.8583,234.6813,1199.2048,234.4871,1199.399,228.8336,1195.55,237.8992" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="1244" y="204.7676">service is enabled</text><!--MD5=[228411fb88ef1bcdfe7f19b853e215d2]
link isServiceEnabled to drop--><path d="M1334.3,161.3592 C1368.09,179.3992 1412,211.2992 1412,255.1992 C1412,255.1992 1412,255.1992 1412,1491.1992 C1412,1554.2292 949.82,1577.8492 785.85,1584.2392 " fill="none" id="isServiceEnabled-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="780.62,1584.4392,789.7727,1588.0763,785.616,1584.2394,789.4529,1580.0827,780.62,1584.4392" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="1413" y="889.7676">service is disabled</text><!--MD5=[939988dada0403ed6d1a4e6924dd7701]
link buffer4_receive to unpack--><path d="M1127.37,274.3592 C1111.2,281.6992 1094.07,291.5492 1081,304.1992 C1068.92,315.8892 1060.19,332.8092 1054.6,346.3092 " fill="none" id="buffer4_receive-&gt;unpack" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1052.68,351.1192,1059.7182,344.2298,1054.5246,346.4719,1052.2825,341.2784,1052.68,351.1192" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="1082" y="317.7676">CONTINUE</text><!--MD5=[02f70f5bfef59fd4c02228f0fd276994]
link buffer4_receive to classify--><path d="M1171.43,274.2292 C1167.05,287.2392 1160.59,305.5292 1154,321.1992 C1141.36,351.2492 1140.64,360.4492 1122,387.1992 C1107.15,408.5092 1086.46,429.5592 1070.57,444.4092 " fill="none" id="buffer4_receive-&gt;classify" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1066.64,448.0492,1075.955,444.8508,1070.3019,444.6448,1070.5079,438.9917,1066.64,448.0492" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="1142" y="374.2676">SKIP</text><!--MD5=[41e6595d93b5d76e06ef1219c230b624]
link buffer4_receive to drop--><path d="M1231.41,274.2392 C1272.55,290.9092 1322,320.7992 1322,368.1992 C1322,368.1992 1322,368.1992 1322,1491.1992 C1322,1544.9492 1263.04,1525.7592 1211,1539.1992 C1060.79,1577.9792 876.72,1585.2792 785.63,1586.3192 " fill="none" id="buffer4_receive-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="780.56,1586.3792,789.6051,1590.2761,785.5597,1586.3221,789.5137,1582.2766,780.56,1586.3792" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="1323" y="946.2676">DROP</text><!--MD5=[1ecae68ae42d9a73e40e9217f03f9ce7]
link unpack to classify--><path d="M1047,387.6192 C1047,403.1592 1047,425.9792 1047,442.8592 " fill="none" id="unpack-&gt;classify" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1047,447.8892,1051,438.8892,1047,442.8892,1043,438.8892,1047,447.8892" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[27fcba0ca5551c2a3eff6088113b3400]
link unpack to drop--><path d="M989.92,372.3892 C772.19,381.1192 6,415.3792 6,465.1992 C6,465.1992 6,465.1992 6,1491.1992 C6,1550.8192 494.13,1542.7992 660,1569.1992 C663.94,1569.8292 667.99,1570.5692 672.05,1571.3792 " fill="none" id="unpack-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="677.2,1572.4492,669.1976,1566.708,672.3038,1571.4357,667.576,1574.5419,677.2,1572.4492" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="7" y="1002.7676">on error</text><!--MD5=[6d44324a94e4b11142830ec71aa81556]
link classify to pkt4_receive--><path d="M1046.82,484.6192 C1046.65,500.1592 1046.41,522.9792 1046.24,539.8592 " fill="none" id="classify-&gt;pkt4_receive" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1046.18,544.8892,1050.2572,535.9239,1046.223,539.8894,1042.2575,535.8552,1046.18,544.8892" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[0057d53684278b0199141f1c920049f3]
link pkt4_receive to drop_class--><path d="M1046,581.5392 C1046,600.7692 1046,631.8292 1046,652.8592 " fill="none" id="pkt4_receive-&gt;drop_class" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1046,657.9792,1050,648.9792,1046,652.9792,1042,648.9792,1046,657.9792" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="1047" y="624.7676">CONTINUE</text><!--MD5=[23d76d484a8ade2f68bc32d339275e55]
link pkt4_receive to drop--><path d="M966.21,565.0492 C735.01,568.5592 81,586.3492 81,675.1992 C81,675.1992 81,675.1992 81,1491.1992 C81,1545.4592 591.2,1557.6492 660,1569.1992 C663.94,1569.8592 667.98,1570.6292 672.04,1571.4592 " fill="none" id="pkt4_receive-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="677.18,1572.5492,669.1971,1566.7809,672.2873,1571.5192,667.549,1574.6093,677.18,1572.5492" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="82" y="1115.7676">DROP</text><!--MD5=[17d61ffc5c9189e7f93f951e2b5510f6]
link drop_class to process--><path d="M1046,694.4592 C1046,703.2642 1046,714.6842 1046,726.8989 C1046,733.0063 1046,739.3123 1046,745.5894 C1046,746.3741 1046,747.1583 1046,747.9415 C1046,748.3332 1046,748.7246 1046,749.1158 " fill="none" id="drop_class-&gt;process" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1046,749.1158,1050,740.1158,1046,744.1158,1042,740.1158,1046,749.1158" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[4eef49efa4e6a39b9cad1f9dd4db75c9]
link drop_class to drop--><path d="M1069.48,694.4292 C1097.62,717.2392 1141,760.3492 1141,809.1992 C1141,809.1992 1141,809.1992 1141,1111.6992 C1141,1146.4992 1147.95,1156.7592 1168,1185.1992 C1180,1202.2192 1192.18,1198.0492 1204,1215.1992 C1221.07,1239.9592 1226,1249.1192 1226,1279.1992 C1226,1279.1992 1226,1279.1992 1226,1491.1992 C1226,1579.8992 916.71,1587.7792 786.11,1587.1492 " fill="none" id="drop_class-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="780.78,1587.1192,789.757,1591.1706,785.7799,1587.1478,789.8027,1583.1707,780.78,1587.1192" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="1169" y="1172.2676">query in DROP class</text><!--MD5=[3640933a3eded42de606c73d1c2efb26]
link process to drop--><path d="M1049.382,852.4605 C1049.3955,852.6507 1049.4089,852.8414 1049.4224,853.0326 C1049.4761,853.7971 1049.53,854.5686 1049.5838,855.3467 C1051.305,880.2467 1053,911.9392 1053,940.1992 C1053,940.1992 1053,940.1992 1053,1491.1992 C1053,1546.2092 878.82,1571.6292 785.88,1581.2692 " fill="none" id="process-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="780.7,1581.7992,790.0638,1584.8519,785.6735,1581.2847,789.2406,1576.8944,780.7,1581.7992" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="1054" y="1228.7676">unknown message type</text><!--MD5=[952846e6e065ca3396c39be4d5d60980]
link processDiscover to lease4_committed--><path d="M485.04,828.3292 C515.43,851.9392 570.11,894.4292 602.62,919.6992 " fill="none" id="processDiscover-&gt;lease4_committed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="606.87,922.9992,602.2281,914.3129,602.9255,919.9265,597.3119,920.624,606.87,922.9992" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[7f61b5f2e024f0ea6329d761794804a2]
link processDiscover to drop--><path d="M441.41,828.4592 C424.87,840.9692 401.05,857.4992 378,868.1992 C366.26,873.6492 361.87,871.0292 350,876.1992 C299.55,898.1692 244,885.1692 244,940.1992 C244,940.1992 244,940.1992 244,1491.1992 C244,1539.4892 609.77,1559.9192 660,1569.1992 C663.92,1569.9292 667.96,1570.7392 672.01,1571.6092 " fill="none" id="processDiscover-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="677.15,1572.7292,669.2157,1566.8942,672.2661,1571.6582,667.5021,1574.7085,677.15,1572.7292" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="245" y="1228.7676">on error</text><!--MD5=[f46ab6743faf3720230dd3ca9adf25a5]
link processRequest to lease4_committed--><path d="M316.31,828.4592 C332.64,840.9692 356.18,857.4992 379,868.1992 C430.4,892.2892 491.59,910.0792 540.57,921.9492 " fill="none" id="processRequest-&gt;lease4_committed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="545.57,923.1492,537.7547,917.1558,540.7086,921.9802,535.8842,924.9341,545.57,923.1492" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[46780bcbdce00599e22cc2808afc4298]
link processRequest to drop--><path d="M252.1,828.3292 C209.97,848.2992 152,885.6992 152,940.1992 C152,940.1992 152,940.1992 152,1491.1992 C152,1536.8592 598.86,1558.4592 660,1569.1992 C663.93,1569.8892 667.97,1570.6792 672.03,1571.5292 " fill="none" id="processRequest-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="677.17,1572.6292,669.2195,1566.8164,672.2831,1571.5718,667.5276,1574.6354,677.17,1572.6292" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="153" y="1228.7676">on error</text><!--MD5=[dd5280f7a4fbe519a789693377d2c3dc]
link processRelease to lease4_committed--><path d="M768.62,828.3292 C739.15,851.9392 686.12,894.4292 654.58,919.6992 " fill="none" id="processRelease-&gt;lease4_committed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="650.47,922.9992,659.9988,920.509,654.3771,919.8792,655.0069,914.2575,650.47,922.9992" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[9c1ccee308c843163ae9c7fab5373c87]
link processRelease to drop--><path d="M809.12,828.3592 C832.5,851.3292 869,894.4992 869,940.1992 C869,940.1992 869,940.1992 869,1168.1992 C869,1245.6192 818.47,1435.0892 793,1508.1992 C787.96,1522.6492 787,1526.8192 778,1539.1992 C771.21,1548.5392 762.44,1557.6192 754.2,1565.2592 " fill="none" id="processRelease-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="750.21,1568.8892,759.5566,1565.7842,753.9058,1565.5216,754.1684,1559.8708,750.21,1568.8892" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="866" y="1228.7676">on error</text><!--MD5=[762f153a4fd6a7efd08d553c7afbf530]
link processDecline to lease4_committed--><path d="M628.13,828.3292 C628.31,851.3592 628.63,892.3592 628.83,917.8192 " fill="none" id="processDecline-&gt;lease4_committed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="628.87,922.9992,632.8185,913.9765,628.8414,917.9993,624.8186,914.0222,628.87,922.9992" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[6d9fbe084438a9903d341665e19467c6]
link processDecline to drop--><path d="M607.69,828.2192 C592.13,840.5992 569.71,857.0892 548,868.1992 C459.43,913.5492 336,840.6892 336,940.1992 C336,940.1992 336,940.1992 336,1168.1992 C336,1321.2792 285.12,1397.6492 391,1508.1992 C475.8,1596.7292 540.7,1540.9792 660,1569.1992 C664.06,1570.1592 668.24,1571.1592 672.46,1572.1792 " fill="none" id="processDecline-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="677.41,1573.3792,669.5987,1567.3806,672.5494,1572.2069,667.723,1575.1576,677.41,1573.3792" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="335" y="1228.7676">on error</text><!--MD5=[403b2bcd25ba6f5a11641c975fae6de0]
link processInform to lease4_committed--><path d="M930.7,828.2292 C915.62,840.7892 893.65,857.4892 872,868.1992 C823.01,892.4392 764.35,910.1092 716.93,921.8792 " fill="none" id="processInform-&gt;lease4_committed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="711.8,923.1392,721.4919,924.8907,716.6574,921.9535,719.5946,917.1189,711.8,923.1392" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[c5223c78dfc731d8a0b6dd3ad2587a32]
link processInform to drop--><path d="M952.39,828.2692 C955.62,852.9292 961,899.9692 961,940.1992 C961,940.1992 961,940.1992 961,1491.1992 C961,1566.5992 854.76,1583.4592 786.07,1586.4692 " fill="none" id="processInform-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="780.78,1586.6792,789.9331,1590.3153,785.776,1586.4788,789.6124,1582.3217,780.78,1586.6792" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="962" y="1228.7676">on error</text><!--MD5=[887612e1a41deb0055e6b261cad7b207]
link lease4_committed to pkt4_send--><path d="M600.35,959.4692 C575.96,975.8892 542.37,1002.9692 526,1036.1992 C508.92,1070.8692 509.72,1117.0692 512.16,1144.0392 " fill="none" id="lease4_committed-&gt;pkt4_send" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="512.66,1149.1592,515.7659,1139.8129,512.1738,1144.1829,507.8038,1140.5908,512.66,1149.1592" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="527" y="1059.2676">CONTINUE</text><!--MD5=[03d4f1b76350f6f230f27d5a69f4e552]
link lease4_committed to drop--><path d="M650.67,959.3192 C659.53,967.4492 669.08,977.8692 675,989.1992 C776.19,1182.8892 746.46,1254.6392 767,1472.1992 C768.5,1488.1292 770.57,1492.5992 767,1508.1992 C763.58,1523.1192 758.7,1525.4392 752,1539.1992 C748.05,1547.3192 743.7,1556.2192 739.86,1564.0592 " fill="none" id="lease4_committed-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="737.54,1568.7992,745.0944,1562.4801,739.7417,1564.3101,737.9117,1558.9574,737.54,1568.7992" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="757" y="1285.2676">DROP</text><!--MD5=[e6b479318b22374427e5a12769813441]
link lease4_committed to park--><path d="M630.25,959.5392 C631.64,978.7692 633.87,1009.8292 635.39,1030.8592 " fill="none" id="lease4_committed-&gt;park" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="635.76,1035.9792,639.1067,1026.7164,635.4027,1030.992,631.1272,1027.288,635.76,1035.9792" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="634" y="1002.7676">PARK</text><!--MD5=[6b0b05ab5b5e01054aa0e3030e86c15b]
link park to pkt4_send--><path d="M618.2,1072.2992 C596.6,1091.9592 561.13,1124.2292 537.92,1145.3492 " fill="none" id="park-&gt;pkt4_send" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="534.02,1148.8992,543.3731,1145.8139,537.7229,1145.5394,537.9974,1139.8892,534.02,1148.8992" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="584" y="1115.7676">unpark</text><!--MD5=[e1e7c40ae99ae9db4be329f6b3cb143f]
link pkt4_send to pack--><path d="M515,1185.5392 C515,1204.7692 515,1235.8292 515,1256.8592 " fill="none" id="pkt4_send-&gt;pack" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="515,1261.9792,519,1252.9792,515,1256.9792,511,1252.9792,515,1261.9792" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="516" y="1228.7676">CONTINUE</text><!--MD5=[729fab78839d14d65a522c939ef9b552]
link pkt4_send to buffer4_send--><path d="M556.05,1185.4192 C569.28,1192.8092 582.86,1202.6692 592,1215.1992 C622.73,1257.3292 629.49,1320.5292 630.82,1353.8392 " fill="none" id="pkt4_send-&gt;buffer4_send" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="630.99,1358.9192,634.6793,1349.7874,630.8187,1353.9222,626.684,1350.0616,630.99,1358.9192" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="625" y="1285.2676">SKIP</text><!--MD5=[7a343c005ca5222349b93a374f6aa4be]
link pkt4_send to drop--><path d="M495.53,1185.4392 C477.37,1202.8192 451.31,1231.4092 439,1262.1992 C398.31,1363.9592 354.72,1421.6892 422,1508.1992 C422.98,1509.4592 584.15,1549.9492 672.54,1572.0792 " fill="none" id="pkt4_send-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="677.47,1573.3192,669.7131,1567.2504,672.6201,1572.1032,667.7674,1575.0102,677.47,1573.3192" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="399" y="1382.2676">DROP</text><!--MD5=[e1b3754cee4214144faeedd0f77d1671]
link pack to buffer4_send--><path d="M536.01,1298.3992 C555.72,1314.5392 585.21,1338.6992 606.09,1355.7992 " fill="none" id="pack-&gt;buffer4_send" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="610.15,1359.1192,605.7226,1350.3216,606.2821,1355.9507,600.653,1356.5102,610.15,1359.1192" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[0fe92c55fb860475c26b6ea914a50894]
link buffer4_send to send--><path d="M625.84,1395.5392 C620.1,1414.8492 610.82,1446.0892 604.56,1467.1292 " fill="none" id="buffer4_send-&gt;send" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="603.12,1471.9792,609.5067,1464.4818,604.537,1467.1842,601.8347,1462.2146,603.12,1471.9792" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="617" y="1438.7676">CONTINUE</text><!--MD5=[887aa11356841167329c21249679272f]
link buffer4_send to drop--><path d="M661.94,1395.2892 C673.3,1403.0292 685.26,1413.1492 693,1425.1992 C720.92,1468.6592 727.37,1530.7892 728.74,1563.7192 " fill="none" id="buffer4_send-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="728.92,1568.7392,732.5832,1559.597,728.7344,1563.7427,724.5887,1559.8939,728.92,1568.7392" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="723" y="1495.2676">DROP</text><!--MD5=[6b25e4fe160ab604f67b02c1ded86970]
link send to drop--><!--MD5=[b13d16fe916d552630640f297118268c]
@startuml

title DHCPv4 packet processing

agent "Receive query" as receivePacket
note left : input

agent "Service Enabled" as isServiceEnabled

agent "Callout buffer4_receive" as buffer4_receive
note right : hook

agent "Unpack query" as unpack

agent "Classify query" as classify

agent "Callout pkt4_receive" as pkt4_receive
note right : hook

agent "Check DROP class" as drop_class

rectangle "Process Query on its Message Type" as process {
 agent "Process Discover" as processDiscover
 agent "Process Request" as processRequest
 agent "Process Release" as processRelease
 agent "Process Decline" as processDecline
 agent "Process Inform" as processInform
}

agent "Callout lease4_committed" as lease4_committed
note right : hook

agent "Park" as park

agent "Callout pkt4_send" as pkt4_send

agent "Send response" as send

agent "Pack response" as pack

agent "Callout buffer4_send" as buffer4_send

agent "Send response" as send
note left : output

agent "Drop packet" as drop
note left : error

receivePacket - -> isServiceEnabled
isServiceEnabled - -> buffer4_receive : service is enabled
isServiceEnabled - - - -> drop : service is disabled
buffer4_receive - -> unpack : CONTINUE
buffer4_receive - -> classify : SKIP
buffer4_receive - - - -> drop : DROP
unpack - -> classify
unpack - - -> drop : on error
classify - -> pkt4_receive
pkt4_receive - -> drop_class : CONTINUE
pkt4_receive - - -> drop : DROP
drop_class - -> process
drop_class - - -> drop : query in DROP class
process - - -> drop : unknown message type
processDiscover - -> lease4_committed
processDiscover - - -> drop : on error
processRequest - -> lease4_committed
processRequest - - -> drop : on error
processRelease - -> lease4_committed
processRelease - - -> drop : on error
processDecline - -> lease4_committed
processDecline - - -> drop : on error
processInform - -> lease4_committed
processInform - - -> drop : on error
lease4_committed - -> pkt4_send : CONTINUE
lease4_committed - - -> drop : DROP
lease4_committed - -> park : PARK
park -[dashed]-> pkt4_send : unpark
pkt4_send - -> pack : CONTINUE
pkt4_send - -> buffer4_send : SKIP
pkt4_send - - -> drop : DROP
pack - -> buffer4_send
buffer4_send - -> send : CONTINUE
buffer4_send - - -> drop : DROP
send -[hidden]-> drop
@enduml

PlantUML version 1.2020.15(Sun Jun 28 13:39:45 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>