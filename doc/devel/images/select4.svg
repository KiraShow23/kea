<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2113px" preserveAspectRatio="none" style="width:1468px;height:2113px;" version="1.1" viewBox="0 0 1468 2113" width="1468px" zoomAndPan="magnify"><defs><filter height="300%" id="fzgkacd0xpkt1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="216" x="617" y="17.4023">DHCPv4 subnet selection</text><!--MD5=[73860abe08ab23c9b8e49eb23f18ae46]
cluster relayed--><rect fill="#FFFFFF" filter="url(#fzgkacd0xpkt1)" height="374.86" style="stroke: #000000; stroke-width: 1.5;" width="445" x="7" y="232.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="201.5" y="247.7344">Relayed</text><!--MD5=[234613e222536af9475ae40e3492b0e6]
cluster set_address--><rect fill="#FFFFFF" filter="url(#fzgkacd0xpkt1)" height="164.86" style="stroke: #000000; stroke-width: 1.5;" width="803" x="227" y="672.0592"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="164" x="546.5" y="687.5944">Set address for lookup</text><!--MD5=[a59c1d05a8f6fb54290705d41e67acbe]
cluster interface--><rect fill="#FFFFFF" filter="url(#fzgkacd0xpkt1)" height="488" style="stroke: #000000; stroke-width: 1.5;" width="395" x="945" y="893.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="164" x="1060.5" y="909.4544">Try incoming interface</text><!--MD5=[8f3f5adf9176dbd9c419c05d483ab0c6]
cluster address--><rect fill="#FFFFFF" filter="url(#fzgkacd0xpkt1)" height="294" style="stroke: #000000; stroke-width: 1.5;" width="190" x="745" y="1430.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="797.5" y="1446.4544">Try address</text><!--MD5=[aeb2f621969028d4547d386ac1a1ba6d]
entity relay_subnet--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="226" x="172" y="321.0592"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="206" x="182" y="344.5944">Relay address matches subnet</text><!--MD5=[bf459b32eaaf498e62edf6d622ac5891]
entity relay_network--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="286" x="142" y="434.0592"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="266" x="152" y="457.5944">Relay address matches shared network</text><!--MD5=[076bfff500cab59e856b606fdf63ed5a]
entity relay_class--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="112" y="547.0592"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120" x="122" y="570.5944">Check client class</text><!--MD5=[467e96f12fdeb7da53b220e72b6eb1fc]
entity relay_address--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="251" y="776.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="261" y="800.4544">Set relay address</text><!--MD5=[a0e4201c97a623c3dfa593fb75aad03b]
entity client_address--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="553" y="776.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120" x="563" y="800.4544">Set client address</text><!--MD5=[a2d7389029b0dd04029e629f1661a883]
entity source_address--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="856.5" y="776.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="129" x="866.5" y="800.4544">Set source address</text><!--MD5=[8eaa1e77cbee43fcac8de4e493864e04]
entity interface_subnet--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="192" x="997" y="928.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="172" x="1007" y="952.4544">Interface matches subnet</text><!--MD5=[44eac5a65cc5cd7e6cc1fc4b89b09f4d]
entity interface_network--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="252" x="1072" y="1041.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="232" x="1082" y="1065.4544">Interface matches shared network</text><!--MD5=[8e51806cb27b2b60db022c6084a961c9]
entity interface_class--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="1022" y="1154.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120" x="1032" y="1178.4544">Check client class</text><!--MD5=[953883d00ea10db133fca33539954fed]
entity interface_address--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="163" x="961.5" y="1329.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="143" x="971.5" y="1353.4544">Set interface address</text><!--MD5=[132ec46735878e55c0250b14c07769ad]
entity inRange--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="761" y="1465.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="771" y="1489.4544">Check subnet prefix</text><!--MD5=[a34f95003b379bc2f5b7f1af307bcb98]
entity address_class--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="779" y="1672.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120" x="789" y="1696.4544">Check client class</text><!--MD5=[e3476fda087b0512b1cf4e3a66ca5e59]
entity entry--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="350.5" y="28.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="360.5" y="51.7344">Entry point</text><!--MD5=[a23c6b9dab1f8744947aaee2891e743e]
entity rai_link_select--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="327.5" y="125.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="337.5" y="148.7344">Try RAI link select</text><!--MD5=[6348f6d706001cc5dc6ed638bec44faf]
entity found--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="708.5" y="1849.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="718.5" y="1873.4544">Found a subnet</text><!--MD5=[7dc9e356e22f2f113ceeb6da807ce9ff]
entity not_found--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="870.5" y="1849.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="117" x="880.5" y="1873.4544">Found no subnet</text><!--MD5=[4a9142d0fee9ff77eb50a001ac7877e7]
entity subnet4_select--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="175" x="767.5" y="1946.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="155" x="777.5" y="1970.4544">Callout subnet4_select</text><!--MD5=[d0fdc5cb89e99cab1ccfec009231794d]
entity success--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="584.5" y="2059.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="594.5" y="2083.4544">Return a subnet</text><!--MD5=[d0255a03afa46a62fe0c456dae837167]
entity no_subnet--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="785.5" y="2059.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="795.5" y="2083.4544">Return no subnet</text><!--MD5=[c92710f32fe9c293a125fb7e80204a05]
entity drop--><rect fill="#FEFECE" filter="url(#fzgkacd0xpkt1)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="986.5" y="2059.9192"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="996.5" y="2083.4544">Drop query</text><!--MD5=[732ffb0ffbc5cdc82abf95e46b9c6dc7]
link entry to rai_link_select--><path d="M398,64.6192 C398,80.1592 398,102.9792 398,119.8592 " fill="none" id="entry-&gt;rai_link_select" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="398,124.8892,402,115.8892,398,119.8892,394,115.8892,398,124.8892" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[5853887b4749cf1e36855f5979bccba8]
link rai_link_select to relayed--><path d="M389.65,161.5692 C382.075,177.3142 370.655,201.0567 361.01,221.1092 C359.8044,223.6158 358.6265,226.0647 357.4873,228.4331 C356.9177,229.6173 356.3578,230.7814 355.8089,231.9225 " fill="none" id="rai_link_select-&gt;relayed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="355.8089,231.9225,363.3147,225.5458,357.9762,227.4167,356.1053,222.0781,355.8089,231.9225" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="374" y="204.7676">relayed</text><!--MD5=[4e1625724f20f702efa0fa07c823f159]
link rai_link_select to set_address--><path d="M433.44,161.3692 C466.58,180.1792 511,213.7592 511,258.5592 C511,258.5592 511,258.5592 511,566.0592 C511,614.2292 468.365,647.0467 425.0638,667.9542 C422.3574,669.2609 419.6485,670.5211 416.9472,671.7356 " fill="none" id="rai_link_select-&gt;set_address" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="416.9472,671.7356,426.796,671.6933,421.5075,669.6853,423.5155,664.3968,416.9472,671.7356" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="512" y="400.6276">not relayed</text><!--MD5=[289599dfcd7d1f32272e42cc3c26c895]
link relayed to relay_subnet--><path d="M342.96,260.1192 C341.81,261.6492 317.61,294.2092 300.84,316.7592 " fill="none" id="relayed-&gt;relay_subnet" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="297.8,320.8392,306.3807,316.0049,300.784,316.8273,299.9616,311.2305,297.8,320.8392" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[65c9b407d2d4ddf1b89c397faeac317e]
link relay_subnet to relay_network--><path d="M285,357.3992 C285,376.6292 285,407.6892 285,428.7192 " fill="none" id="relay_subnet-&gt;relay_network" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="285,433.8392,289,424.8392,285,428.8392,281,424.8392,285,433.8392" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="286" y="400.6276">no match</text><!--MD5=[918f6d4a891df42092f9be64f359f985]
link relay_subnet to relay_class--><path d="M199.58,357.0892 C156.79,370.3892 108.74,393.6992 83,434.0592 C56.99,474.8592 109.58,518.9992 147.59,543.9192 " fill="none" id="relay_subnet-&gt;relay_class" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="152.15,546.8592,146.7424,538.6277,147.9441,544.1554,142.4164,545.3571,152.15,546.8592" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="84" y="457.1276">match</text><!--MD5=[ec56da742308e5dcfe86ad0421278606]
link relay_network to set_address--><path d="M288.52,470.3092 C294.12,497.7992 305.4675,553.4892 315.5475,602.9592 C320.5875,627.6942 325.3106,650.8742 328.84,668.1967 C329.0606,669.2794 329.2765,670.3392 329.4876,671.375 " fill="none" id="relay_network-&gt;set_address" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="329.4876,671.375,331.6103,661.7576,328.4893,666.4756,323.7713,663.3547,329.4876,671.375" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="319" y="570.1276">no match</text><!--MD5=[a30462b61ddf59585f12c8e1078496e0]
link relay_network to relay_class--><path d="M268.91,470.3992 C250.69,490.0392 221.02,522.0092 201.5,543.0392 " fill="none" id="relay_network-&gt;relay_class" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="197.98,546.8392,207.0376,542.9713,201.3844,543.1773,201.1785,537.5242,197.98,546.8392" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="241" y="513.6276">match</text><!--MD5=[44feab40ce9c0df31465bdb13adac7ed]
link relay_class to found--><path d="M177.97,583.0792 C172.39,608.1692 163,656.6292 163,698.4192 C163,698.4192 163,698.4192 163,1781.4192 C163,1835.4492 543.78,1857.4892 703.15,1864.3492 " fill="none" id="relay_class-&gt;found" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="708.26,1864.5692,699.4395,1860.1875,703.2646,1864.3551,699.097,1868.1802,708.26,1864.5692" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="164" y="1265.4876">compatible</text><!--MD5=[d5e1893c7bc3c7589901f4b78d6439f0]
link relay_class to set_address--><path d="M185.6,583.2592 C190.22,601.4992 199.91,630.0992 218,648.0592 C222.9438,652.9667 228.4423,657.4291 234.2844,661.4815 C237.2054,663.5077 240.2123,665.4314 243.2786,667.2571 C244.8117,668.1699 246.3597,669.0582 247.9193,669.9226 C248.6991,670.3547 249.4818,670.7809 250.2669,671.2012 C250.6595,671.4113 251.0527,671.6199 251.4464,671.8271 " fill="none" id="relay_class-&gt;set_address" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="251.4464,671.8271,245.3441,664.0965,247.0215,669.499,241.6191,671.1764,251.4464,671.8271" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="219" y="644.6276">not compatible</text><!--MD5=[3f679d64a1cccee12b0e824b1733c0ed]
link set_address to relay_address--><path d="M334.99,699.9892 C334.66,701.9192 327.44,744.3492 322.81,771.5092 " fill="none" id="set_address-&gt;relay_address" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="321.93,776.7292,327.3899,768.5323,322.7728,771.8008,319.5043,767.1837,321.93,776.7292" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="330" y="743.4876">try the relay addreess</text><!--MD5=[9d0435cdb5bba0d446c223c46240db6f]
link relay_address to client_address--><path d="M387.22,794.9192 C434.95,794.9192 498.7,794.9192 547.88,794.9192 " fill="none" id="relay_address-&gt;client_address" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="552.9,794.9192,543.9,790.9192,547.9,794.9192,543.9,798.9192,552.9,794.9192" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="405.5" y="788.4876">has no relay address</text><!--MD5=[4192df04ddbb3f1e00a57ee174f51cdb]
link client_address to source_address--><path d="M693.28,794.9192 C740.3,794.9192 802.28,794.9192 851.17,794.9192 " fill="none" id="client_address-&gt;source_address" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="856.46,794.9192,847.46,790.9192,851.46,794.9192,847.46,798.9192,856.46,794.9192" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="711.25" y="788.4876">has no client addrss</text><!--MD5=[1cd4e848379fc555ffa76a6d3111f3fb]
link source_address to interface_subnet--><path d="M949.58,813.1292 C979.61,840.9292 1038.68,895.6192 1070.85,925.4092 " fill="none" id="source_address-&gt;interface_subnet" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1074.63,928.9092,1070.7255,919.8674,1070.9543,925.5196,1065.3021,925.7484,1074.63,928.9092" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="1017" y="874.4876">no suitable address</text><!--MD5=[a29ca77fdc41863d51ecafa8e32dcb85]
link relay_address to inRange--><path d="M319,813.0192 C319,840.8592 319,897.7392 319,945.9192 C319,945.9192 319,945.9192 319,1348.9192 C319,1437.9892 608.22,1468.7192 755.69,1478.5992 " fill="none" id="relay_address-&gt;inRange" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="760.87,1478.9392,752.1525,1474.356,755.8808,1478.6104,751.6264,1482.3387,760.87,1478.9392" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="320" y="1177.9876">has a relay address</text><!--MD5=[bf38c5431748c4414750c7275409615d]
link client_address to inRange--><path d="M598.14,813.0992 C565.15,838.1492 511,888.0692 511,945.9192 C511,945.9192 511,945.9192 511,1348.9192 C511,1401.7592 658.41,1443.8992 755.88,1465.9892 " fill="none" id="client_address-&gt;inRange" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="760.78,1467.0892,752.8657,1461.2272,755.8997,1466.0015,751.1254,1469.0356,760.78,1467.0892" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="512" y="1177.9876">has a client address</text><!--MD5=[306377b471c1f30003804df3ba3e4280]
link source_address to inRange--><path d="M856.74,812.9992 C791.87,832.8492 708,872.6692 708,945.9192 C708,945.9192 708,945.9192 708,1348.9192 C708,1401.6392 760.49,1441.1592 799.27,1463.1592 " fill="none" id="source_address-&gt;inRange" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="803.93,1465.7492,798.0248,1457.8671,799.5653,1463.3101,794.1222,1464.8506,803.93,1465.7492" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="709" y="1177.9876">has source addess and use unicast</text><!--MD5=[4c5f9760336ab58778079bb174cbf5f0]
link interface_subnet to not_found--><path d="M1183.41,964.9192 C1267.54,983.3992 1380,1016.1092 1380,1058.9192 C1380,1058.9192 1380,1058.9192 1380,1781.4192 C1380,1855.2692 1138.67,1866.6392 1013.06,1867.5692 " fill="none" id="interface_subnet-&gt;not_found" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1007.91,1867.5992,1016.9327,1871.5477,1012.9099,1867.5706,1016.887,1863.5479,1007.91,1867.5992" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="1381" y="1411.4876">no interface</text><!--MD5=[f6d146b568a537518d52dd0109d2cafd]
link interface_subnet to interface_class--><path d="M1071.84,965.1092 C1052.58,982.2392 1025.46,1010.4692 1014,1041.9192 C998.88,1083.3992 1037.07,1126.3392 1065.19,1151.0092 " fill="none" id="interface_subnet-&gt;interface_class" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1069.26,1154.5192,1065.0657,1145.6081,1065.4768,1151.25,1059.835,1151.6612,1069.26,1154.5192" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="1015" y="1064.9876">match</text><!--MD5=[8c73b6f253b7f8003f1aeec9d3e2c401]
link interface_subnet to interface_network--><path d="M1109.41,965.2592 C1127.98,984.8992 1158.22,1016.8692 1178.12,1037.8992 " fill="none" id="interface_subnet-&gt;interface_network" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1181.71,1041.6992,1178.417,1032.4172,1178.2685,1038.0721,1172.6136,1037.9236,1181.71,1041.6992" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="1152" y="1008.4876">no match</text><!--MD5=[8a490629b42afa0a067bde343f0409be]
link interface_network to interface_class--><path d="M1181.44,1078.2592 C1162.69,1097.8992 1132.15,1129.8692 1112.07,1150.8992 " fill="none" id="interface_network-&gt;interface_class" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1108.45,1154.6992,1117.5542,1150.9424,1111.899,1151.0792,1111.7622,1145.424,1108.45,1154.6992" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="1152" y="1121.4876">march</text><!--MD5=[e1288d340d0c431aabe10a4c239c74f7]
link interface_network to not_found--><path d="M1216.94,1078.1492 C1237.06,1098.4392 1266,1134.1792 1266,1171.9192 C1266,1171.9192 1266,1171.9192 1266,1781.4192 C1266,1833.4492 1109.1,1854.4192 1012.67,1862.3992 " fill="none" id="interface_network-&gt;not_found" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1007.55,1862.8192,1016.8511,1866.058,1012.5327,1862.404,1016.1867,1858.0856,1007.55,1862.8192" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="1267" y="1488.9876">no match</text><!--MD5=[9d13a96273b9c1dbfb8a7fbd997b0088]
link interface_class to found--><path d="M1111.94,1191.2092 C1127.1,1205.7092 1146.84,1227.8592 1156,1251.9192 C1203,1375.3792 1160.06,1417.0492 1168,1548.9192 C1169,1565.6092 1171,1569.6992 1171,1586.4192 C1171,1586.4192 1171,1586.4192 1171,1781.4192 C1171,1782.4592 954.79,1828.2992 840.68,1852.4192 " fill="none" id="interface_class-&gt;found" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="835.66,1853.4792,845.2955,1855.5181,840.5505,1852.4384,843.6302,1847.6934,835.66,1853.4792" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="1169" y="1545.4876">compatible</text><!--MD5=[d4a81a9eb6ae9754c2f91708a00f90ba]
link interface_class to interface_address--><path d="M1081.97,1190.9492 C1073.39,1206.3492 1061.43,1229.9092 1055,1251.9192 C1047.93,1276.1292 1045.02,1305.0192 1043.83,1324.5292 " fill="none" id="interface_class-&gt;interface_address" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1043.54,1329.7692,1048.0484,1321.0128,1043.8261,1324.7774,1040.0615,1320.5551,1043.54,1329.7692" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="1056" y="1265.4876">not compatible</text><!--MD5=[18f0036984a219b8e279d39e6955cbb3]
link interface_address to inRange--><path d="M961.24,1357.9892 C910.72,1365.4692 852.64,1378.1192 837,1397.9192 C823.19,1415.3892 826.7,1441.7792 831.91,1460.5092 " fill="none" id="interface_address-&gt;inRange" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="833.41,1465.5792,834.6953,1455.8146,831.993,1460.7842,827.0233,1458.0818,833.41,1465.5792" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="838" y="1411.4876">has an interface address</text><!--MD5=[1be935c2e674a39bb491f742257146af]
link interface_address to not_found--><path d="M1037.7,1366.0692 C1030.36,1391.3792 1018,1440.3192 1018,1482.9192 C1018,1482.9192 1018,1482.9192 1018,1781.4192 C1018,1809.2692 995.11,1831.9092 973.97,1846.8892 " fill="none" id="interface_address-&gt;not_found" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="969.77,1849.7792,979.4482,1847.9538,973.8835,1846.9369,974.9005,1841.3722,969.77,1849.7792" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="1019" y="1639.4876">no interface address</text><!--MD5=[65c872516cd5acbef394f498ee60e6f6]
link inRange to address_class--><path d="M840.75,1502.0492 C842.38,1539.0492 846.21,1626.4492 848.02,1667.6692 " fill="none" id="inRange-&gt;address_class" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="848.24,1672.6992,851.8498,1663.5358,848.0253,1667.7038,843.8572,1663.8793,848.24,1672.6992" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="845" y="1592.4876">match</text><!--MD5=[c6a81dd9b5c38fb7a31992aeb43efba5]
link inRange to not_found--><path d="M768.39,1501.9792 C726.98,1516.5792 683,1542.4392 683,1586.4192 C683,1586.4192 683,1586.4192 683,1781.4192 C683,1800.7892 789.82,1830.8092 865.46,1849.6392 " fill="none" id="inRange-&gt;not_found" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="870.4,1850.8692,862.6221,1844.8274,865.5459,1849.67,860.7033,1852.5938,870.4,1850.8692" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="684" y="1695.9876">no match</text><!--MD5=[6bbdb059bb8431be14feb2edf9179bcc]
link address_class to found--><path d="M815.7,1708.9392 C765.48,1735.3692 674.36,1786.6192 657,1818.9192 C644.07,1842.9792 671.86,1854.9792 703.35,1860.9692 " fill="none" id="address_class-&gt;found" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="708.43,1861.8792,700.2794,1856.3504,703.5088,1860.9948,698.8644,1864.2243,708.43,1861.8792" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="708" y="1785.4876">compatible</text><!--MD5=[6fa859304e08ed6b1a2f69b396a973f6]
link address_class to not_found--><path d="M856.62,1708.9192 C865.47,1728.4292 880.68,1761.2892 895,1788.9192 C904.99,1808.1792 917.16,1829.6292 926.17,1845.1492 " fill="none" id="address_class-&gt;not_found" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="928.86,1849.7592,927.7843,1839.9693,926.3424,1845.4393,920.8724,1843.9974,928.86,1849.7592" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="896" y="1785.4876">not compatible</text><!--MD5=[920af236d2bfe8ac015294b6ec32c751]
link found to subnet4_select--><path d="M787.22,1886.3392 C801.03,1902.1492 821.43,1925.4892 836.24,1942.4392 " fill="none" id="found-&gt;subnet4_select" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="839.87,1946.6092,836.9563,1937.2012,836.5785,1942.8454,830.9343,1942.4676,839.87,1946.6092" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[be5a985c5094547d1aa8a3dfda06631d]
link not_found to subnet4_select--><path d="M923.59,1886.3392 C909.62,1902.1492 888.98,1925.4892 873.99,1942.4392 " fill="none" id="not_found-&gt;subnet4_select" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="870.31,1946.6092,879.2712,1942.523,873.6247,1942.8659,873.2818,1937.2194,870.31,1946.6092" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[085d72d70044aeb14e8d963046e88b11]
link found to not_found--><!--MD5=[d0da1e00427a0ca7837196c7dddb3af4]
link subnet4_select to success--><path d="M767.05,1973.2692 C735.7,1979.7092 702,1991.4992 677,2012.9192 C664.53,2023.5992 657.42,2040.8792 653.49,2054.7992 " fill="none" id="subnet4_select-&gt;success" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="652.18,2059.7492,658.3343,2052.0599,653.4497,2054.9131,650.5965,2050.0285,652.18,2059.7492" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="678" y="2026.4876">CONTINUE and subnet set</text><!--MD5=[48d8edc0219dd4d7c3847b4159c280ef]
link subnet4_select to no_subnet--><path d="M853.62,1983.3192 C852.99,1992.1692 852.31,2003.1092 852,2012.9192 C851.56,2026.8292 852.26,2042.4292 853.1,2054.7492 " fill="none" id="subnet4_select-&gt;no_subnet" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="853.47,2059.8092,856.8167,2050.5464,853.1127,2054.822,848.8372,2051.118,853.47,2059.8092" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="853" y="2026.4876">SKIP or subnet not set</text><!--MD5=[f590b573e48b5dfdcd1774729941f83a]
link subnet4_select to drop--><path d="M938.2,1983.0192 C958.54,1989.9392 979.25,1999.5792 996,2012.9192 C1009.78,2023.8892 1019.89,2041.1592 1026.36,2054.9892 " fill="none" id="subnet4_select-&gt;drop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1028.58,2059.9192,1028.5229,2050.0705,1026.5228,2055.362,1021.2313,2053.362,1028.58,2059.9192" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="1012" y="2026.4876">DROP</text><!--MD5=[8a6ededd5ab0492adf89ee9e73320547]
@startuml

title DHCPv4 subnet selection

agent "Entry point" as entry

agent "Try RAI link select" as rai_link_select

rectangle "Relayed" as relayed {
 agent "Relay address matches subnet" as relay_subnet
 agent "Relay address matches shared network" as relay_network
 agent "Check client class" as relay_class
}

rectangle "Set address for lookup" as set_address {
 agent "Set relay address" as relay_address
 agent "Set client address" as client_address
 agent "Set source address" as source_address
}

rectangle "Try incoming interface" as interface {
 agent "Interface matches subnet" as interface_subnet
 agent "Interface matches shared network" as interface_network
 agent "Check client class" as interface_class
 agent "Set interface address" as interface_address
}

rectangle "Try address" as address {
 agent "Check subnet prefix" as inRange
 agent "Check client class" as address_class
}

agent "Found a subnet" as found

agent "Found no subnet" as not_found

agent "Callout subnet4_select" as subnet4_select

agent "Return a subnet" as success

agent "Return no subnet" as no_subnet

agent "Drop query" as drop

entry - -> rai_link_select
rai_link_select - -> relayed : relayed
rai_link_select - -> set_address : not relayed
relayed - -> relay_subnet
relay_subnet - -> relay_network : no match
relay_subnet - -> relay_class : match
relay_network - -> set_address : no match
relay_network - -> relay_class : match
relay_class - - -> found : compatible
relay_class - -> set_address : not compatible
set_address - -> relay_address : try the relay addreess
relay_address -r-> client_address : has no relay address
client_address -r-> source_address : has no client addrss
source_address - -> interface_subnet : no suitable address
relay_address - -> inRange : has a relay address
client_address - -> inRange : has a client address
source_address - -> inRange : has source addess and use unicast
interface_subnet - - -> not_found : no interface
interface_subnet - -> interface_class : match
interface_subnet - -> interface_network : no match
interface_network - -> interface_class : march
interface_network - - -> not_found : no match
interface_class - - -> found : compatible
interface_class - - -> interface_address : not compatible
interface_address - -> inRange : has an interface address
interface_address - - -> not_found : no interface address
inRange - - -> address_class : match
inRange - - -> not_found : no match
address_class - - -> found : compatible
address_class - - -> not_found : not compatible
found - -> subnet4_select
not_found - -> subnet4_select
found -[hidden]> not_found
subnet4_select - -> success : CONTINUE and subnet set
subnet4_select - -> no_subnet : SKIP or subnet not set
subnet4_select - -> drop : DROP

@endutl

PlantUML version 1.2020.15(Sun Jun 28 13:39:45 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>