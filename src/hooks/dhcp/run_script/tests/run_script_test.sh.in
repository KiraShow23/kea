#!/bin/sh

# Copyright (C) 2021 Internet Systems Consortium, Inc. ("ISC")
#
# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

# Exit with error if commands exit with non-zero and if undefined variables are
# used.
set -eu

LOG_FILE="@abs_top_builddir@/src/hooks/dhcp/run_script/tests/test.log"

ECHO_TO_FILE() {
    echo ${@} > ${LOG_FILE}
}

ASSERT_EQ() {
    if ! test $EXPECTED = $ACTUAL; then
        ECHO_TO_FILE "Values differ:\n:
        ECHO_TO_FILE "\texpected: ${EXPECTED}\n"
        ECHO_TO_FILE "\tactual: ${ACTUAL}\n"
        ECHO_TO_FILE "FAILED"
        exit 123
    fi
}

unknown_handle() {
    ECHO_TO_FILE "Unhandled function call\n"
    exit 123
}

lease4_renew () {
    ECHO_TO_FILE "SUCCESS"
}

lease4_expire () {
    ECHO_TO_FILE "SUCCESS"
}

lease4_recover () {
    ECHO_TO_FILE "SUCCESS"
}

leases4_committed () {
    ECHO_TO_FILE "SUCCESS"
}

lease4_release () {
    ECHO_TO_FILE "SUCCESS"
}

lease4_decline () {
    ECHO_TO_FILE "SUCCESS"
}

lease6_renew () {
    ECHO_TO_FILE "SUCCESS"
}

lease6_rebind () {
    ECHO_TO_FILE "SUCCESS"
}

lease6_expire () {
    ECHO_TO_FILE "SUCCESS"
}

lease6_recover () {
    ECHO_TO_FILE "SUCCESS"
}

leases6_committed () {
    ECHO_TO_FILE "SUCCESS"
}

lease6_release () {
    ECHO_TO_FILE "SUCCESS"
}

lease6_decline () {
    ECHO_TO_FILE "SUCCESS"
}

case "$1" in
    "lease4_renew")
        lease4_renew
        ;;
    "lease4_expire")
        lease4_expire
        ;;
    "lease4_recover")
        lease4_recover
        ;;
    "leases4_committed")
        leases4_committed
        ;;
    "lease4_release")
        lease4_release
        ;;
    "lease4_decline")
        lease4_decline
        ;;
    "lease6_renew")
        lease6_renew
        ;;
    "lease6_rebind")
        lease6_rebind
        ;;
    "lease6_expire")
        lease6_expire
        ;;
    "lease6_recover")
        lease6_recover
        ;;
    "leases6_committed")
        leases6_committed
        ;;
    "lease6_release")
        lease6_release
        ;;
    "lease6_decline")
        lease6_decline
        ;;
    *)
        unknown_handle
        ;;
esac
